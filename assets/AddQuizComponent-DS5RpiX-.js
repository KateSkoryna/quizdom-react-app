import{r as d,j as e,w as Be,x as Le,k as Oe,l as Ge}from"./index-DyhLML9L.js";import{c as re,A as Ue,a as We,r as J,M as He,B as Ve,F as ne,g as Ke,o as Xe,b as Ye,t as Ze,u as P,d as ee}from"./store-u8uNkhr8.js";import{u as v,c as C,d as Je,a as Pe}from"./divWithClassName-D4tezO6z.js";import{c as et,b as te,C as q}from"./types-BZHA2PIJ.js";import{F as l}from"./Form-D-DclIb9.js";import{b as A,C as tt,c as ae,u as st,F as ot}from"./index.esm-YgwjaYS4.js";import{C as M,Q as rt}from"./const-DqjIPBY2.js";import{d as nt}from"./index-D7FuTWNp.js";import{a as y}from"./addClassnameToText-BQjz-c35.js";import{B as w,C as le}from"./Col-Dxu5OJYM.js";function at(){return d.useState(null)}var F;function se(t){if((!F&&F!==0||t)&&re){var s=document.createElement("div");s.style.position="absolute",s.style.top="-9999px",s.style.width="50px",s.style.height="50px",s.style.overflow="scroll",document.body.appendChild(s),F=s.offsetWidth-s.clientWidth,document.body.removeChild(s)}return F}const ce=d.forwardRef(({className:t,bsPrefix:s,as:n="div",...o},a)=>(s=v(s,"modal-body"),e.jsx(n,{ref:a,className:C(t,s),...o})));ce.displayName="ModalBody";const Q=d.forwardRef(({bsPrefix:t,className:s,contentClassName:n,centered:o,size:a,fullscreen:m,children:g,scrollable:c,...i},h)=>{t=v(t,"modal");const u=`${t}-dialog`,p=typeof m=="string"?`${t}-fullscreen-${m}`:`${t}-fullscreen`;return e.jsx("div",{...i,ref:h,className:C(u,s,a&&`${t}-${a}`,o&&`${u}-centered`,c&&`${u}-scrollable`,m&&p),children:e.jsx("div",{className:C(`${t}-content`,n),children:g})})});Q.displayName="ModalDialog";const ie=d.forwardRef(({className:t,bsPrefix:s,as:n="div",...o},a)=>(s=v(s,"modal-footer"),e.jsx(n,{ref:a,className:C(t,s),...o})));ie.displayName="ModalFooter";const de=d.forwardRef(({bsPrefix:t,className:s,closeLabel:n="Close",closeButton:o=!1,...a},m)=>(t=v(t,"modal-header"),e.jsx(Ue,{ref:m,...a,className:C(s,t),closeLabel:n,closeButton:o})));de.displayName="ModalHeader";const lt=Je("h4"),ue=d.forwardRef(({className:t,bsPrefix:s,as:n=lt,...o},a)=>(s=v(s,"modal-title"),e.jsx(n,{ref:a,className:C(t,s),...o})));ue.displayName="ModalTitle";function ct(t){return e.jsx(ne,{...t,timeout:null})}function it(t){return e.jsx(ne,{...t,timeout:null})}const me=d.forwardRef(({bsPrefix:t,className:s,style:n,dialogClassName:o,contentClassName:a,children:m,dialogAs:g=Q,"data-bs-theme":c,"aria-labelledby":i,"aria-describedby":h,"aria-label":u,show:p=!1,animation:x=!0,backdrop:f=!0,keyboard:b=!0,onEscapeKeyDown:T,onShow:j,onHide:k,container:he,autoFocus:pe=!0,enforceFocus:xe=!0,restoreFocus:fe=!0,restoreFocusOptions:ge,onEntered:je,onExit:_,onExiting:ye,onEnter:B,onEntering:L,onExited:O,backdropClassName:G,manager:U,...Ce},be)=>{const[we,Ne]=d.useState({}),[Me,W]=d.useState(!1),E=d.useRef(!1),$=d.useRef(!1),R=d.useRef(null),[S,ve]=at(),Te=et(be,ve),H=te(k),ke=Pe();t=v(t,"modal");const Re=d.useMemo(()=>({onHide:H}),[H]);function V(){return U||Ke({isRTL:ke})}function K(r){if(!re)return;const N=V().getScrollbarWidth()>0,Z=r.scrollHeight>Xe(r).documentElement.clientHeight;Ne({paddingRight:N&&!Z?se():void 0,paddingLeft:!N&&Z?se():void 0})}const z=te(()=>{S&&K(S.dialog)});We(()=>{J(window,"resize",z),R.current==null||R.current()});const Se=()=>{E.current=!0},qe=r=>{E.current&&S&&r.target===S.dialog&&($.current=!0),E.current=!1},X=()=>{W(!0),R.current=Ze(S.dialog,()=>{W(!1)})},Ae=r=>{r.target===r.currentTarget&&X()},Fe=r=>{if(f==="static"){Ae(r);return}if($.current||r.target!==r.currentTarget){$.current=!1;return}k==null||k()},Ie=r=>{b?T==null||T(r):(r.preventDefault(),f==="static"&&X())},Ee=(r,N)=>{r&&K(r),B==null||B(r,N)},$e=r=>{R.current==null||R.current(),_==null||_(r)},ze=(r,N)=>{L==null||L(r,N),Ye(window,"resize",z)},De=r=>{r&&(r.style.display=""),O==null||O(r),J(window,"resize",z)},Qe=d.useCallback(r=>e.jsx("div",{...r,className:C(`${t}-backdrop`,G,!x&&"show")}),[x,G,t]),Y={...n,...we};Y.display="block";const _e=r=>e.jsx("div",{role:"dialog",...r,style:Y,className:C(s,t,Me&&`${t}-static`,!x&&"show"),onClick:f?Fe:void 0,onMouseUp:qe,"data-bs-theme":c,"aria-label":u,"aria-labelledby":i,"aria-describedby":h,children:e.jsx(g,{...Ce,onMouseDown:Se,className:o,contentClassName:a,children:m})});return e.jsx(He.Provider,{value:Re,children:e.jsx(Ve,{show:p,ref:Te,backdrop:f,container:he,keyboard:!0,autoFocus:pe,enforceFocus:xe,restoreFocus:fe,restoreFocusOptions:ge,onEscapeKeyDown:Ie,onShow:j,onHide:k,onEnter:Ee,onEntering:ze,onEntered:je,onExit:$e,onExiting:ye,onExited:De,manager:V(),transition:x?ct:void 0,backdropTransition:x?it:void 0,renderBackdrop:Qe,renderDialog:_e})})});me.displayName="Modal";const I=Object.assign(me,{Body:ce,Header:de,Title:ue,Footer:ie,Dialog:Q,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),dt=t=>{switch(t){case"1":return M[q.BEGINNER];case"2":return M[q.MEDIUM];case"3":return M[q.ADVANCED];case"4":return M[q.EXPERT];default:return M[q.BEGINNER]}},ut=({fieldName:t})=>{const{control:s}=A();return e.jsx(tt,{control:s,name:t,render:({field:{onChange:n,value:o}})=>e.jsxs(l.Group,{className:"mb-3",controlId:t,children:[e.jsxs(l.Label,{children:["Complexity level: ",dt(o)]}),e.jsx(l.Range,{onChange:a=>{n(a.target.value)},min:1,max:4,step:1,value:o})]})})},mt=Object.entries(rt),ht=({fieldName:t})=>{const{register:s}=A();return e.jsxs(l.Group,{className:"mb-2",controlId:"category",children:[e.jsx(l.Label,{children:"Category"}),e.jsxs(l.Select,{"aria-label":"Default select example",...s(t),children:[e.jsx("option",{children:"Choose a category"}),mt.map(([n,o])=>e.jsx("option",{value:o,children:o},n))]})]})},pt="_checkbox_ut4xm_1",xt="_checkboxIconWrapper_ut4xm_10",ft="_checkboxIcon_ut4xm_10",D={checkbox:pt,checkboxIconWrapper:xt,checkboxIcon:ft},gt=({label:t,nestIndex:s,index:n})=>{const{register:o}=A();return e.jsx("div",{className:D.checkbox,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",...o(`questions[${s}].answers[${n}].isCorrect`)}),e.jsx("span",{className:D.checkboxIconWrapper,children:e.jsx(nt,{className:D.checkboxIcon})}),t]})})},jt="_errorText_1l6iq_1",yt={errorText:jt},Ct=({nestIndex:t})=>{const{control:s,register:n,formState:{errors:o}}=A(),{fields:a,remove:m,append:g}=ae({control:s,name:`questions[${t}].answers`});return e.jsxs(l.Group,{className:"mb-3",controlId:"div-questions",children:[a.map((c,i)=>{var u,p,x,f,b;const h=(b=(f=(x=(p=(u=o==null?void 0:o.questions)==null?void 0:u[t])==null?void 0:p.answers)==null?void 0:x[i])==null?void 0:f.answer)==null?void 0:b.message;return e.jsxs(l.Group,{className:"mb-3",controlId:`answer-${i}-${c.id}`,children:[d.createElement(l.Control,{...n(`questions[${t}].answers[${i}].answer`,{required:"Answer is required",minLength:{value:3,message:"Answer must be at least 4 characters"}}),type:"text",placeholder:"Add answer ...",key:c.id}),h?y("text-danger",h):y(yt.errorText),e.jsxs(l.Group,{className:"d-flex justify-content-between",controlId:`isCorrect-${i}-${c.id}`,children:[e.jsx(gt,{label:"Choose correct answer",nestIndex:t,index:i}),e.jsx(w,{type:"button",onClick:()=>m(i),children:"Remove answer"})]})]},c.id)}),e.jsx(w,{type:"button",onClick:()=>g({answer:"",isCorrect:!1}),children:"Add Answer"})]})},bt="_errorText_1l6iq_1",wt={errorText:bt},Nt=()=>{const{control:t,register:s,formState:{errors:n}}=A(),{fields:o,append:a,remove:m}=ae({control:t,name:"questions"});return e.jsxs(l.Group,{className:"mb-3",controlId:"div-questions",children:[o.map((g,c)=>{var h,u,p;const i=(p=(u=(h=n==null?void 0:n.questions)==null?void 0:h[c])==null?void 0:u.questionTitle)==null?void 0:p.message;return e.jsxs(l.Group,{className:"mb-3",controlId:`question-${c}`,children:[e.jsxs("div",{className:"d-flex justify-content-between mb-3",children:[e.jsxs(l.Label,{className:"mb-0 align-self-center",children:["Question ",c+1]}),c>0&&e.jsx(w,{onClick:()=>m(c),children:"Remove Question"})]}),e.jsx(l.Control,{...s(`questions[${c}].questionTitle`,{required:"Question title is required",minLength:{value:4,message:"Question title must be at least 4 characters"}}),type:"text",placeholder:"Add question ..."}),i?y("text-danger",i):y(wt.errorText),e.jsx(Ct,{nestIndex:c})]},g.id)}),e.jsx(l.Group,{className:"text-center",children:e.jsx(w,{onClick:()=>a({questionTitle:"",answers:[{answer:"",isCorrect:!1},{answer:"",isCorrect:!1}]}),children:"Add Question"})})]})},Mt="_errorText_1l6iq_1",oe={errorText:Mt},vt=({handleClose:t})=>{var b,T;const s=P(j=>j.newQuizData),n=P(j=>j.setNewQuizData),o=st({mode:"onChange",defaultValues:s}),{register:a,handleSubmit:m,setError:g,reset:c,formState:{errors:i,isDirty:h,isSubmitting:u}}=o,p=async j=>{try{await Be(Le(Oe,"quizes"),{...j,author:Ge.currentUser.uid,publishedAt:new Date,complexity:M[j.complexity]}),n(j),c()}catch{g("root",{message:"Failed to create a quiz"})}},x=(b=i.title)==null?void 0:b.message,f=(T=i.description)==null?void 0:T.message;return e.jsx(le,{children:e.jsx(ot,{...o,children:e.jsxs(l,{onSubmit:m(p),children:[e.jsxs(l.Group,{className:"mb-3",controlId:"div-title",children:[e.jsx(l.Label,{children:"Quiz Title"}),e.jsx(l.Control,{...a("title",{required:"Title is required",minLength:8}),type:"text",placeholder:"Best Quiz ever...",autoFocus:!0}),x?y("text-danger",x):y(oe.errorText)]}),e.jsxs(l.Group,{className:"mb-3",controlId:"div-description",children:[e.jsx(l.Label,{children:"Quiz Description"}),e.jsx(l.Control,{...a("description",{required:"Description is required",minLength:8}),as:"textarea",rows:3}),f?y("text-danger",f):y(oe.errorText)]}),e.jsx(ut,{fieldName:"complexity"}),e.jsx(ht,{fieldName:"category"}),e.jsx("h5",{className:"mx-auto mb-3 mt-3 text-center",children:"Add your questions"}),e.jsx(Nt,{}),e.jsxs("div",{className:"d-flex justify-content-center",children:[e.jsx(w,{className:"me-3",variant:"secondary",onClick:t,children:"Close Quiz"}),e.jsx(w,{type:"submit",disabled:!h||u,children:u?"Submitting...":"Save Quiz"})]})]})})})},Tt=({showModal:t,handleCloseModal:s})=>e.jsxs(I,{size:"lg",show:t,onHide:s,scrollable:!0,dialogClassName:"h-75",children:[e.jsx(I.Header,{closeButton:!0,children:e.jsx(I.Title,{as:"h2",children:"Create your own Quiz"})}),e.jsx(I.Body,{children:e.jsx(vt,{handleClose:s})})]}),Dt=()=>{const t=ee(a=>a.show),s=ee(a=>a.setShow),n=()=>{s(!1)},o=()=>{s(!0)};return e.jsxs(le,{className:"text-end",children:[e.jsx(w,{onClick:o,children:"Add Quiz"}),e.jsx(Tt,{showModal:t,handleCloseModal:n})]})};export{Dt as A,I as M};
