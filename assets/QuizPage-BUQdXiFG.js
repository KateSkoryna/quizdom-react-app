import{r as n,j as e,a as R,w as $,x as K,y as X,z as Z}from"./index-MuCFj5nI.js";import{C as N}from"./Card-C7rcnU2f.js";import{b as J,c as ee}from"./index-BCu5u5ZR.js";import{B as I,C as A}from"./Col-CMSdG19z.js";import{M as b,A as te}from"./AddQuizComponent-Dd32m_EQ.js";import{u as D,c as M}from"./divWithClassName-PIdDVMOf.js";import{a as se,m as re,b as oe,u as ae,B as ne}from"./types-COfAX2O5.js";import{t as O}from"./truncateString-DL5WhCmR.js";import{Q as ce,C as ie}from"./const-B1oEj4dp.js";import{F as G}from"./Form-1QgDQl4a.js";import{L as le}from"./Loader-CYI54JBH.js";import"./index-B2q41j2n.js";import"./store-HnSe--Jm.js";import"./index.esm-BZhr--Vz.js";import"./addClassnameToText-CvYG5FHj.js";const U=n.forwardRef(({bsPrefix:r,active:c,disabled:t,eventKey:s,className:m,variant:h,action:x,as:l,...o},u)=>{r=D(r,"list-group-item");const[a,i]=se({key:re(s,o.href),active:c,...o}),z=oe(y=>{if(t){y.preventDefault(),y.stopPropagation();return}a.onClick(y)});t&&o.tabIndex===void 0&&(o.tabIndex=-1,o["aria-disabled"]=!0);const f=l||(x?o.href?"a":"button":"div");return e.jsx(f,{ref:u,...o,...a,onClick:z,className:M(m,r,i.isActive&&"active",t&&"disabled",h&&`${r}-${h}`,x&&`${r}-action`)})});U.displayName="ListGroupItem";const V=n.forwardRef((r,c)=>{const{className:t,bsPrefix:s,variant:m,horizontal:h,numbered:x,as:l="div",...o}=ae(r,{activeKey:"onSelect"}),u=D(s,"list-group");let a;return h&&(a=h===!0?"horizontal":`horizontal-${h}`),e.jsx(ne,{ref:c,...o,as:l,className:M(t,u,m&&`${u}-${m}`,a&&`${u}-${a}`,x&&`${u}-numbered`)})});V.displayName="ListGroup";const E=Object.assign(V,{Item:U}),ue="_cardBody_h0hdy_1",de="_favoriteIcon_h0hdy_6",me="_itemSmalltext_h0hdy_13",he="_buttonContainer_h0hdy_24",xe="_quizDescription_h0hdy_35",fe="_checkbox_h0hdy_41",pe="_checkboxIconWrapper_h0hdy_53",ye="_checkboxIcon_h0hdy_53",k={cardBody:ue,favoriteIcon:de,itemSmalltext:me,buttonContainer:he,quizDescription:xe,checkbox:fe,checkboxIconWrapper:pe,checkboxIcon:ye},je="_isCorrect_129mc_1",ge="_isFalse_129mc_5",Ce="_questionTitle_129mc_9",_e="_resultBody_129mc_13",S={isCorrect:je,isFalse:ge,questionTitle:Ce,resultBody:_e},be=({show:r,handleClose:c,questions:t})=>{const[s,m]=n.useState(0),[h,x]=n.useState(t[s]),[l,o]=n.useState(t[s].answers),[u,a]=n.useState(!1),[i,z]=n.useState(0),[f,y]=n.useState(!1),Q=n.useRef(null),j=n.useRef(null),B=n.useRef(null),w=n.useRef(null),v=[Q,j,B,w],H=(d,g)=>{u||(g?(d.currentTarget.classList.add(S.isCorrect),a(!0),z(p=>p+1)):(d.currentTarget.classList.add(S.isFalse),a(!0),l.forEach((p,C)=>{var _,F,T;(_=v[C])!=null&&_.current&&p.isCorrect&&((T=(F=v[C])==null?void 0:F.current)==null||T.classList.add(S.isCorrect))})))},W=()=>{if(u){if(s===t.length-1)return y(!0),0;m(d=>d+1),x(t[s+1]),o(t[s+1].answers),a(!1),l.forEach((d,g)=>{var p,C,_;(p=v[g])!=null&&p.current&&d.isCorrect&&((_=(C=v[g])==null?void 0:C.current)==null||_.classList.remove(S.isCorrect))})}},Y=()=>{m(d=>d-1),x(t[s-1]),o(t[s-1].answers),a(!1),l.forEach((d,g)=>{var p,C,_;(p=v[g])!=null&&p.current&&d.isCorrect&&((_=(C=v[g])==null?void 0:C.current)==null||_.classList.remove(S.isCorrect))})},q=()=>{m(0),x(t[0]),o(t[0].answers),a(!1),z(0),y(!1)};return e.jsx(b,{show:r,onHide:c,fullscreen:"md-down",centered:!0,children:f?e.jsxs(e.Fragment,{children:[e.jsx(b.Header,{closeButton:!0,children:e.jsx(b.Title,{children:"Quiz Result"})}),e.jsxs(b.Body,{className:S.resultBody,children:[e.jsxs("h5",{children:["Your score is ",i," out of ",t.length]}),e.jsxs("h6",{children:["Correct answers: ",i/t.length*100,"%"]}),e.jsx("h5",{children:"Thank you for taking the quiz!"}),e.jsx(I,{onClick:q,className:S.button,children:"Reset Quiz"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(b.Header,{closeButton:!0,children:e.jsxs(b.Title,{children:["Question ",s+1]})}),e.jsxs(b.Body,{children:[e.jsx("h5",{className:S.questionTitle,children:h.questionTitle}),e.jsx(E,{children:l.map((d,g)=>e.jsx(E.Item,{ref:v[g],as:"li",className:"d-flex justify-content-between align-items-start",onClick:p=>H(p,d.isCorrect),children:e.jsx("div",{className:"ms-2 me-auto",children:e.jsx("div",{className:"fw-bold",children:d.answer})})},d.answer))})]}),e.jsxs(b.Footer,{className:"d-flex justify-content-center",children:[e.jsx(I,{variant:"secondary",disabled:s===0,onClick:Y,children:"Previous Question"}),e.jsx(I,{onClick:W,variant:"primary",children:"Next Question"}),e.jsxs("h6",{children:["Total Questions: ",s+1," of ",t.length]})]})]})})},Se=({quiz:{title:r,complexity:c,description:t,id:s,authorName:m,publishedAt:h,questions:x}})=>{const[l,o]=n.useState(!1),[u,a]=n.useState(!1),i=()=>o(!1),z=()=>o(!0),{currentUser:f,setCurrentUser:y}=R(),Q=async j=>{if(f){if(!j.target.checked){await $(j.target.id,f.id,"remove"),a(!1),y(B=>({...B??{},favorites:f.favorites.filter(w=>w!==j.target.id)}));return}await $(j.target.id,f.id,"add"),a(!0),y(B=>({...B??{},favorites:[...f.favorites,j.target.id]}))}};return n.useEffect(()=>{f&&f.favorites.includes(s)&&a(!0)},[]),e.jsxs(N.Body,{className:k.cardBody,children:[e.jsx("div",{className:k.checkbox,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:u,onChange:j=>Q(j),id:s}),u?e.jsx(J,{className:k.favoriteIcon,style:{fill:"#F7941D"}}):e.jsx(ee,{className:k.favoriteIcon,style:{fill:"gray"}})]})}),e.jsx(N.Title,{children:O(r,40)}),e.jsx(N.Subtitle,{className:"mb-2 text-muted",children:c}),e.jsx(N.Text,{className:k.quizDescription,children:O(t,80)}),e.jsxs("div",{className:k.buttonContainer,children:[e.jsx(N.Link,{onClick:z,as:I,children:"Start Quiz"}),e.jsx(N.Link,{as:I,children:"Share Quiz"})]}),e.jsxs("small",{className:k.itemSmalltext,children:["Published on: ",h.toLocaleDateString()," by ",m]}),l&&e.jsx(be,{show:l,handleClose:i,questions:x})]})},ve=({quizes:r})=>e.jsx(A,{style:{paddingBottom:"80px",marginTop:"20px"},children:r.map(c=>e.jsx(N,{style:{width:"100%",marginBottom:"10px"},children:e.jsx(Se,{quiz:c})},c.id))}),ke="_container_clstf_1",Ne="_form_clstf_7",ze="_button_clstf_19",Ie="_error_clstf_29",L={container:ke,form:Ne,button:ze,error:Ie},Be="_selectCategory_13j12_1",Le={selectCategory:Be},P=({fields:r,fieldsName:c,handleChange:t})=>e.jsxs(G.Select,{className:Le.selectCategory,onChange:s=>t(s.target.value),defaultValue:`Open ${c} menu`,children:[e.jsx("option",{children:`Open ${c} menu`}),r.map(s=>e.jsx("option",{value:s,children:s},s))]}),Qe=Object.values(ce),we=Object.values(ie),Fe={category:"",complexity:""},Te=()=>{const[r,c]=K(Fe),[t,s]=n.useState(r.get("category")??""),[m,h]=n.useState(r.get("complexity")??""),[x,l]=n.useState(!1),o=i=>{if(i.preventDefault(),!t&&!m){l(!0);return}c({category:t,complexity:m})},u=i=>{if(console.log(i),i==="Open category menu"){s("");return}l(!1),s(i)},a=i=>{if(console.log(i),i==="Open complexity menu"){h("");return}l(!1),h(i)};return e.jsxs(A,{className:L.container,children:[e.jsxs(G,{className:L.form,onSubmit:o,children:[e.jsx(P,{fields:Qe,fieldsName:"category",handleChange:u}),e.jsx(P,{fields:we,fieldsName:"complexity",handleChange:a}),e.jsx(I,{className:L.button,type:"submit",children:"Search"})]}),x&&e.jsx("p",{className:L.error,children:"Please select search query"})]})},Ke=()=>{const r=X(),c=Z(),{currentUser:t}=R();return e.jsxs(e.Fragment,{children:[e.jsx(Te,{}),t&&e.jsx(te,{}),r.state==="loading"?e.jsx(le,{}):e.jsx(ve,{quizes:c})]})};export{Ke as default};
