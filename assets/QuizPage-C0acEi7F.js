import{r as o,j as e,a as R,t as $,o as Y,p as K,q as X,v as Z}from"./index-DAw0QWaD.js";import{C as I}from"./Card-D_AozXHt.js";import{b as J,c as ee}from"./index-Dk4Vkuxe.js";import{B as z,C as A}from"./Col-CNch9nHO.js";import{M as S,A as te}from"./AddQuizComponent-CXI4SNvq.js";import{u as D,c as M}from"./divWithClassName-Bhqs9IOV.js";import{a as se,m as re,b as oe,u as ne,B as ae}from"./types-CHgZx90x.js";import{Q as ce,C as ie}from"./const-BczVbE39.js";import{F as U}from"./Form-D165iaPw.js";import{L as le}from"./Loader-m2Oi67_f.js";import"./index-Dfkrjrg8.js";import"./store-DR3u43wq.js";import"./index.esm-6pYVB_yH.js";import"./addClassnameToText-BS-NYplg.js";const G=o.forwardRef(({bsPrefix:r,active:n,disabled:t,eventKey:s,className:h,variant:x,action:f,as:u,...a},d)=>{r=D(r,"list-group-item");const[c,i]=se({key:re(s,a.href),active:n,...a}),y=oe(_=>{if(t){_.preventDefault(),_.stopPropagation();return}c.onClick(_)});t&&a.tabIndex===void 0&&(a.tabIndex=-1,a["aria-disabled"]=!0);const B=u||(f?a.href?"a":"button":"div");return e.jsx(B,{ref:d,...a,...c,onClick:y,className:M(h,r,i.isActive&&"active",t&&"disabled",x&&`${r}-${x}`,f&&`${r}-action`)})});G.displayName="ListGroupItem";const V=o.forwardRef((r,n)=>{const{className:t,bsPrefix:s,variant:h,horizontal:x,numbered:f,as:u="div",...a}=ne(r,{activeKey:"onSelect"}),d=D(s,"list-group");let c;return x&&(c=x===!0?"horizontal":`horizontal-${x}`),e.jsx(ae,{ref:n,...a,as:u,className:M(t,d,h&&`${d}-${h}`,c&&`${d}-${c}`,f&&`${d}-numbered`)})});V.displayName="ListGroup";const O=Object.assign(V,{Item:G}),ue="_cardBody_15txn_1",de="_titleContainer_15txn_6",me="_favoriteIcon_15txn_12",he="_itemSmalltext_15txn_19",xe="_buttonContainer_15txn_27",fe="_quizDescription_15txn_38",pe="_checkbox_15txn_44",je="_checkboxIconWrapper_15txn_53",Ce="_checkboxIcon_15txn_53",v={cardBody:ue,titleContainer:de,favoriteIcon:me,itemSmalltext:he,buttonContainer:xe,quizDescription:fe,checkbox:pe,checkboxIconWrapper:je,checkboxIcon:Ce},ge="_isCorrect_129mc_1",ye="_isFalse_129mc_5",_e="_questionTitle_129mc_9",be="_resultBody_129mc_13",k={isCorrect:ge,isFalse:ye,questionTitle:_e,resultBody:be},Ne=({show:r,handleClose:n,questions:t})=>{const[s,h]=o.useState(0),[x,f]=o.useState(t[s]),[u,a]=o.useState(t[s].answers),[d,c]=o.useState(!1),[i,y]=o.useState(0),[B,_]=o.useState(!1),C=o.useRef(null),L=o.useRef(null),w=o.useRef(null),j=o.useRef(null),l=[C,L,w,j],F=(m,g)=>{d||(g?(m.currentTarget.classList.add(k.isCorrect),c(!0),y(p=>p+1)):(m.currentTarget.classList.add(k.isFalse),c(!0),u.forEach((p,b)=>{var N,T,E;(N=l[b])!=null&&N.current&&p.isCorrect&&((E=(T=l[b])==null?void 0:T.current)==null||E.classList.add(k.isCorrect))})))},q=()=>{if(d){if(s===t.length-1)return _(!0),0;h(m=>m+1),f(t[s+1]),a(t[s+1].answers),c(!1),u.forEach((m,g)=>{var p,b,N;(p=l[g])!=null&&p.current&&m.isCorrect&&((N=(b=l[g])==null?void 0:b.current)==null||N.classList.remove(k.isCorrect))})}},H=()=>{h(m=>m-1),f(t[s-1]),a(t[s-1].answers),c(!1),u.forEach((m,g)=>{var p,b,N;(p=l[g])!=null&&p.current&&m.isCorrect&&((N=(b=l[g])==null?void 0:b.current)==null||N.classList.remove(k.isCorrect))})},W=()=>{h(0),f(t[0]),a(t[0].answers),c(!1),y(0),_(!1)};return e.jsx(S,{show:r,onHide:n,fullscreen:"md-down",centered:!0,children:B?e.jsxs(e.Fragment,{children:[e.jsx(S.Header,{closeButton:!0,children:e.jsx(S.Title,{children:"Quiz Result"})}),e.jsxs(S.Body,{className:k.resultBody,children:[e.jsxs("h5",{children:["Your score is ",i," out of ",t.length]}),e.jsxs("h6",{children:["Correct answers: ",i/t.length*100,"%"]}),e.jsx("h5",{children:"Thank you for taking the quiz!"}),e.jsx(z,{onClick:W,className:k.button,children:"Reset Quiz"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(S.Header,{closeButton:!0,children:e.jsxs(S.Title,{children:["Question ",s+1]})}),e.jsxs(S.Body,{children:[e.jsx("h5",{className:k.questionTitle,children:x.questionTitle}),e.jsx(O,{children:u.map((m,g)=>e.jsx(O.Item,{ref:l[g],as:"li",className:"d-flex justify-content-between align-items-start",onClick:p=>F(p,m.isCorrect),children:e.jsx("div",{className:"ms-2 me-auto",children:e.jsx("div",{className:"fw-bold",children:m.answer})})},m.answer))})]}),e.jsxs(S.Footer,{className:"d-flex justify-content-center",children:[e.jsx(z,{variant:"secondary",disabled:s===0,onClick:H,children:"Previous Question"}),e.jsx(z,{onClick:q,variant:"primary",children:"Next Question"}),e.jsxs("h6",{children:["Total Questions: ",s+1," of ",t.length]})]})]})})},Se=({quiz:{title:r,complexity:n,description:t,id:s,author:h,publishedAt:x,questions:f}})=>{const[u,a]=o.useState(""),[d,c]=o.useState(!1),[i,y]=o.useState(!1),B=()=>c(!1),_=()=>c(!0),{currentUser:C,setCurrentUser:L}=R(),w=async j=>{if(C){if(!j.target.checked){await $(j.target.id,C.id,"remove"),y(!1),L(l=>({...l??{},favorites:C.favorites.filter(F=>F!==j.target.id)}));return}await $(j.target.id,C.id,"add"),y(!0),L(l=>({...l??{},favorites:[...C.favorites,j.target.id]}))}};return o.useEffect(()=>{(async()=>{try{const l=await Y(h);a(l),C&&C.favorites.includes(s)&&y(!0)}catch(l){if(l instanceof Error)throw new Error(l.message)}})()},[]),e.jsxs(I.Body,{className:v.cardBody,children:[e.jsxs(I.Title,{className:v.titleContainer,children:[e.jsx("h5",{children:r}),e.jsx("div",{className:v.checkbox,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:i,onChange:j=>w(j),id:s}),i?e.jsx(J,{className:v.favoriteIcon,style:{fill:"#F7941D"}}):e.jsx(ee,{className:v.favoriteIcon,style:{fill:"gray"}})]})})]}),e.jsx(I.Subtitle,{className:"mb-2 text-muted",children:n}),e.jsx(I.Text,{className:v.quizDescription,children:t}),e.jsxs("div",{className:v.buttonContainer,children:[e.jsx(I.Link,{onClick:_,as:z,children:"Start Quiz"}),e.jsx(I.Link,{as:z,children:"Share Quiz"})]}),e.jsxs("small",{className:v.itemSmalltext,children:["Published on: ",x.toLocaleDateString()," by ",u]}),d&&e.jsx(Ne,{show:d,handleClose:B,questions:f})]})},ve=({quizes:r})=>e.jsx(A,{style:{paddingBottom:"80px",marginTop:"20px"},children:r.map(n=>e.jsx(I,{style:{width:"100%",marginBottom:"10px"},children:e.jsx(Se,{quiz:n})},n.id))}),ke="_container_clstf_1",Ie="_form_clstf_7",ze="_button_clstf_19",Be="_error_clstf_29",Q={container:ke,form:Ie,button:ze,error:Be},Le="_selectCategory_13j12_1",Qe={selectCategory:Le},P=({fields:r,fieldsName:n,handleChange:t})=>e.jsxs(U.Select,{className:Qe.selectCategory,onChange:s=>t(s.target.value),defaultValue:`Open ${n} menu`,children:[e.jsx("option",{children:`Open ${n} menu`}),r.map(s=>e.jsx("option",{value:s,children:s},s))]}),we=Object.values(ce),Fe=Object.values(ie),Te={category:"",complexity:""},Ee=()=>{const[r,n]=K(Te),[t,s]=o.useState(r.get("category")??""),[h,x]=o.useState(r.get("complexity")??""),[f,u]=o.useState(!1),a=i=>{if(i.preventDefault(),!t&&!h){u(!0);return}n({category:t,complexity:h})},d=i=>{if(console.log(i),i==="Open category menu"){s("");return}u(!1),s(i)},c=i=>{if(console.log(i),i==="Open complexity menu"){x("");return}u(!1),x(i)};return e.jsxs(A,{className:Q.container,children:[e.jsxs(U,{className:Q.form,onSubmit:a,children:[e.jsx(P,{fields:we,fieldsName:"category",handleChange:d}),e.jsx(P,{fields:Fe,fieldsName:"complexity",handleChange:c}),e.jsx(z,{className:Q.button,type:"submit",children:"Search"})]}),f&&e.jsx("p",{className:Q.error,children:"Please select search query"})]})},Ke=()=>{const r=X(),n=Z(),{currentUser:t}=R();return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{}),t&&e.jsx(te,{}),r.state==="loading"?e.jsx(le,{}):e.jsx(ve,{quizes:n})]})};export{Ke as default};
