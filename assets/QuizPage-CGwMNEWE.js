import{r as o,j as e,a as P,t as E,o as Y,p as K,q as X,v as Z}from"./index-DyhLML9L.js";import{C as I}from"./Card-CgSQyeMi.js";import{b as J,c as ee}from"./index-BKyST9mi.js";import{B,C as R}from"./Col-Dxu5OJYM.js";import{M as b,A as te}from"./AddQuizComponent-DS5RpiX-.js";import{u as A,c as D}from"./divWithClassName-D4tezO6z.js";import{a as se,m as re,b as oe,u as ne,B as ae}from"./types-BZHA2PIJ.js";import{Q as ce,C as ie}from"./const-DqjIPBY2.js";import{F as M}from"./Form-D-DclIb9.js";import{L as le}from"./Loader-C0UxyskO.js";import"./index-D7FuTWNp.js";import"./store-u8uNkhr8.js";import"./index.esm-YgwjaYS4.js";import"./addClassnameToText-BQjz-c35.js";const U=o.forwardRef(({bsPrefix:r,active:n,disabled:t,eventKey:s,className:m,variant:h,action:x,as:l,...a},u)=>{r=A(r,"list-group-item");const[c,i]=se({key:re(s,a.href),active:n,...a}),j=oe(C=>{if(t){C.preventDefault(),C.stopPropagation();return}c.onClick(C)});t&&a.tabIndex===void 0&&(a.tabIndex=-1,a["aria-disabled"]=!0);const L=l||(x?a.href?"a":"button":"div");return e.jsx(L,{ref:u,...a,...c,onClick:j,className:D(m,r,i.isActive&&"active",t&&"disabled",h&&`${r}-${h}`,x&&`${r}-action`)})});U.displayName="ListGroupItem";const G=o.forwardRef((r,n)=>{const{className:t,bsPrefix:s,variant:m,horizontal:h,numbered:x,as:l="div",...a}=ne(r,{activeKey:"onSelect"}),u=A(s,"list-group");let c;return h&&(c=h===!0?"horizontal":`horizontal-${h}`),e.jsx(ae,{ref:n,...a,as:l,className:D(t,u,m&&`${u}-${m}`,c&&`${u}-${c}`,x&&`${u}-numbered`)})});G.displayName="ListGroup";const $=Object.assign(G,{Item:U}),ue="_cardBody_15txn_1",de="_titleContainer_15txn_6",me="_favoriteIcon_15txn_12",he="_itemSmalltext_15txn_19",xe="_buttonContainer_15txn_27",fe="_quizDescription_15txn_38",pe="_checkbox_15txn_44",je="_checkboxIconWrapper_15txn_53",Ce="_checkboxIcon_15txn_53",N={cardBody:ue,titleContainer:de,favoriteIcon:me,itemSmalltext:he,buttonContainer:xe,quizDescription:fe,checkbox:pe,checkboxIconWrapper:je,checkboxIcon:Ce},ye="_isCorrect_129mc_1",ge="_isFalse_129mc_5",_e="_questionTitle_129mc_9",be="_resultBody_129mc_13",S={isCorrect:ye,isFalse:ge,questionTitle:_e,resultBody:be},Ne=({show:r,handleClose:n,questions:t})=>{const[s,m]=o.useState(0),[h,x]=o.useState(t[s]),[l,a]=o.useState(t[s].answers),[u,c]=o.useState(!1),[i,j]=o.useState(0),[L,C]=o.useState(!1),k=o.useRef(null),w=o.useRef(null),y=o.useRef(null),z=o.useRef(null),v=[k,w,y,z],V=(d,p)=>{u||(p?(d.currentTarget.classList.add(S.isCorrect),c(!0),j(f=>f+1)):(d.currentTarget.classList.add(S.isFalse),c(!0),l.forEach((f,g)=>{var _,F,T;(_=v[g])!=null&&_.current&&f.isCorrect&&((T=(F=v[g])==null?void 0:F.current)==null||T.classList.add(S.isCorrect))})))},q=()=>{if(u){if(s===t.length-1)return C(!0),0;m(d=>d+1),x(t[s+1]),a(t[s+1].answers),c(!1),l.forEach((d,p)=>{var f,g,_;(f=v[p])!=null&&f.current&&d.isCorrect&&((_=(g=v[p])==null?void 0:g.current)==null||_.classList.remove(S.isCorrect))})}},H=()=>{m(d=>d-1),x(t[s-1]),a(t[s-1].answers),c(!1),l.forEach((d,p)=>{var f,g,_;(f=v[p])!=null&&f.current&&d.isCorrect&&((_=(g=v[p])==null?void 0:g.current)==null||_.classList.remove(S.isCorrect))})},W=()=>{m(0),x(t[0]),a(t[0].answers),c(!1),j(0),C(!1)};return e.jsx(b,{show:r,onHide:n,fullscreen:"md-down",centered:!0,children:L?e.jsxs(e.Fragment,{children:[e.jsx(b.Header,{closeButton:!0,children:e.jsx(b.Title,{children:"Quiz Result"})}),e.jsxs(b.Body,{className:S.resultBody,children:[e.jsxs("h5",{children:["Your score is ",i," out of ",t.length]}),e.jsxs("h6",{children:["Correct answers: ",i/t.length*100,"%"]}),e.jsx("h5",{children:"Thank you for taking the quiz!"}),e.jsx(B,{onClick:W,className:S.button,children:"Reset Quiz"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(b.Header,{closeButton:!0,children:e.jsxs(b.Title,{children:["Question ",s+1]})}),e.jsxs(b.Body,{children:[e.jsx("h5",{className:S.questionTitle,children:h.questionTitle}),e.jsx($,{children:l.map((d,p)=>e.jsx($.Item,{ref:v[p],as:"li",className:"d-flex justify-content-between align-items-start",onClick:f=>V(f,d.isCorrect),children:e.jsx("div",{className:"ms-2 me-auto",children:e.jsx("div",{className:"fw-bold",children:d.answer})})},d.answer))})]}),e.jsxs(b.Footer,{className:"d-flex justify-content-center",children:[e.jsx(B,{variant:"secondary",disabled:s===0,onClick:H,children:"Previous Question"}),e.jsx(B,{onClick:q,variant:"primary",children:"Next Question"}),e.jsxs("h6",{children:["Total Questions: ",s+1," of ",t.length]})]})]})})},Se=({quiz:{title:r,complexity:n,description:t,id:s,author:m,publishedAt:h,questions:x}})=>{const[l,a]=o.useState(""),[u,c]=o.useState(!1),[i,j]=o.useState(!1),L=()=>c(!1),C=()=>c(!0),{currentUser:k}=P(),w=async y=>{if(k){if(!y.target.checked){await E(y.target.id,k.id,"remove"),j(!1);return}await E(y.target.id,k.id,"add"),j(!0)}};return o.useEffect(()=>{(async()=>{try{const z=await Y(m);a(z),k&&k.favorites.includes(s)&&j(!0)}catch(z){if(z instanceof Error)throw new Error(z.message)}})()},[]),e.jsxs(I.Body,{className:N.cardBody,children:[e.jsxs(I.Title,{className:N.titleContainer,children:[e.jsx("h5",{children:r}),e.jsx("div",{className:N.checkbox,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:i,onChange:y=>w(y),id:s}),i?e.jsx(J,{className:N.favoriteIcon,style:{fill:"#F7941D"}}):e.jsx(ee,{className:N.favoriteIcon,style:{fill:"gray"}})]})})]}),e.jsx(I.Subtitle,{className:"mb-2 text-muted",children:n}),e.jsx(I.Text,{className:N.quizDescription,children:t}),e.jsxs("div",{className:N.buttonContainer,children:[e.jsx(I.Link,{onClick:C,as:B,children:"Start Quiz"}),e.jsx(I.Link,{as:B,children:"Share Quiz"})]}),e.jsxs("small",{className:N.itemSmalltext,children:["Published on: ",h.toLocaleDateString()," by ",l]}),u&&e.jsx(Ne,{show:u,handleClose:L,questions:x})]})},ke=({quizes:r})=>e.jsx(R,{style:{paddingBottom:"80px",marginTop:"20px"},children:r.map(n=>e.jsx(I,{style:{width:"100%",marginBottom:"10px"},children:e.jsx(Se,{quiz:n})},n.id))}),ve="_container_clstf_1",Ie="_form_clstf_7",ze="_button_clstf_19",Be="_error_clstf_29",Q={container:ve,form:Ie,button:ze,error:Be},Le="_selectCategory_13j12_1",Qe={selectCategory:Le},O=({fields:r,fieldsName:n,handleChange:t})=>e.jsxs(M.Select,{className:Qe.selectCategory,onChange:s=>t(s.target.value),defaultValue:`Open ${n} menu`,children:[e.jsx("option",{children:`Open ${n} menu`}),r.map(s=>e.jsx("option",{value:s,children:s},s))]}),we=Object.values(ce),Fe=Object.values(ie),Te={category:"",complexity:""},Ee=()=>{const[r,n]=K(Te),[t,s]=o.useState(r.get("category")??""),[m,h]=o.useState(r.get("complexity")??""),[x,l]=o.useState(!1),a=i=>{if(i.preventDefault(),!t&&!m){l(!0);return}n({category:t,complexity:m})},u=i=>{if(console.log(i),i==="Open category menu"){s("");return}l(!1),s(i)},c=i=>{if(console.log(i),i==="Open complexity menu"){h("");return}l(!1),h(i)};return e.jsxs(R,{className:Q.container,children:[e.jsxs(M,{className:Q.form,onSubmit:a,children:[e.jsx(O,{fields:we,fieldsName:"category",handleChange:u}),e.jsx(O,{fields:Fe,fieldsName:"complexity",handleChange:c}),e.jsx(B,{className:Q.button,type:"submit",children:"Search"})]}),x&&e.jsx("p",{className:Q.error,children:"Please select search query"})]})},Ke=()=>{const r=X(),n=Z(),{currentUser:t}=P();return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{}),t&&e.jsx(te,{}),r.state==="loading"?e.jsx(le,{}):e.jsx(ke,{quizes:n})]})};export{Ke as default};
