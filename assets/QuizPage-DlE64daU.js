import{r as n,j as e,u as X,L as M,a as D,w as E,x as Z,Q as J,C as ee,y as te,z as se}from"./index-CF4BZSwz.js";import{C as k}from"./Card-ODVbB7cX.js";import{b as re,c as oe}from"./index-CjL8ZMgD.js";import{B as z,C as U}from"./Col-BKrQtQl3.js";import{M as f,A as ne}from"./AddQuizComponent-CyAnRIbV.js";import{u as G,c as H}from"./divWithClassName-CqVDt4wl.js";import{a as ae,m as ce,b as ie,u as le,B as de}from"./Nav-DUdp610D.js";import{t as P}from"./truncateString-DL5WhCmR.js";import{u as ue}from"./store-Bl6cf_eT.js";import{F as q}from"./Form-DFKeUo6o.js";import{L as he}from"./Loader-BUN1BE40.js";import"./index-BSR-7LsB.js";import"./index.esm-BVrSUjAK.js";import"./addClassnameToText-D9RW85vf.js";const V=n.forwardRef(({bsPrefix:r,active:o,disabled:t,eventKey:s,className:d,variant:a,action:j,as:u,...c},m)=>{r=G(r,"list-group-item");const[i,l]=ae({key:ce(s,c.href),active:o,...c}),N=ie(C=>{if(t){C.preventDefault(),C.stopPropagation();return}i.onClick(C)});t&&c.tabIndex===void 0&&(c.tabIndex=-1,c["aria-disabled"]=!0);const B=u||(j?c.href?"a":"button":"div");return e.jsx(B,{ref:m,...c,...i,onClick:N,className:H(d,r,l.isActive&&"active",t&&"disabled",a&&`${r}-${a}`,j&&`${r}-action`)})});V.displayName="ListGroupItem";const Y=n.forwardRef((r,o)=>{const{className:t,bsPrefix:s,variant:d,horizontal:a,numbered:j,as:u="div",...c}=le(r,{activeKey:"onSelect"}),m=G(s,"list-group");let i;return a&&(i=a===!0?"horizontal":`horizontal-${a}`),e.jsx(de,{ref:o,...c,as:u,className:H(t,m,d&&`${m}-${d}`,i&&`${m}-${i}`,j&&`${m}-numbered`)})});Y.displayName="ListGroup";const A=Object.assign(Y,{Item:V}),me="_cardBody_h0hdy_1",xe="_favoriteIcon_h0hdy_6",fe="_itemSmalltext_h0hdy_13",je="_buttonContainer_h0hdy_24",pe="_quizDescription_h0hdy_35",ye="_checkbox_h0hdy_41",ge="_checkboxIconWrapper_h0hdy_53",Ce="_checkboxIcon_h0hdy_53",S={cardBody:me,favoriteIcon:xe,itemSmalltext:fe,buttonContainer:je,quizDescription:pe,checkbox:ye,checkboxIconWrapper:ge,checkboxIcon:Ce},_e="_isCorrect_129mc_1",be="_isFalse_129mc_5",ve="_questionTitle_129mc_9",Ne="_resultBody_129mc_13",v={isCorrect:_e,isFalse:be,questionTitle:ve,resultBody:Ne},Se=({show:r,handleClose:o,questions:t})=>{const[s,d]=n.useState(0),[a,j]=n.useState(t[s]),[u,c]=n.useState(t[s].answers),[m,i]=n.useState(!1),[l,N]=n.useState(0),[B,C]=n.useState(!1),w=n.useRef(null),y=n.useRef(null),L=n.useRef(null),F=n.useRef(null),h=[w,y,L,F],I=(x,g)=>{m||(g?(x.currentTarget.classList.add(v.isCorrect),i(!0),N(p=>p+1)):(x.currentTarget.classList.add(v.isFalse),i(!0),u.forEach((p,_)=>{var b,O,$;(b=h[_])!=null&&b.current&&p.isCorrect&&(($=(O=h[_])==null?void 0:O.current)==null||$.classList.add(v.isCorrect))})))},T=()=>{if(m){if(s===t.length-1)return C(!0),0;d(x=>x+1),j(t[s+1]),c(t[s+1].answers),i(!1),u.forEach((x,g)=>{var p,_,b;(p=h[g])!=null&&p.current&&x.isCorrect&&((b=(_=h[g])==null?void 0:_.current)==null||b.classList.remove(v.isCorrect))})}},W=()=>{d(x=>x-1),j(t[s-1]),c(t[s-1].answers),i(!1),u.forEach((x,g)=>{var p,_,b;(p=h[g])!=null&&p.current&&x.isCorrect&&((b=(_=h[g])==null?void 0:_.current)==null||b.classList.remove(v.isCorrect))})},K=()=>{d(0),j(t[0]),c(t[0].answers),i(!1),N(0),C(!1)};return e.jsx(f,{show:r,onHide:o,fullscreen:"md-down",centered:!0,children:B?e.jsxs(e.Fragment,{children:[e.jsx(f.Header,{closeButton:!0,children:e.jsx(f.Title,{children:"Quiz Result"})}),e.jsxs(f.Body,{className:v.resultBody,children:[e.jsxs("h5",{children:["Your score is ",l," out of ",t.length]}),e.jsxs("h6",{children:["Correct answers: ",l/t.length*100,"%"]}),e.jsx("h5",{children:"Thank you for taking the quiz!"}),e.jsx(z,{onClick:K,className:v.button,children:"Reset Quiz"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(f.Header,{closeButton:!0,children:e.jsxs(f.Title,{children:["Question ",s+1]})}),e.jsxs(f.Body,{children:[e.jsx("h5",{className:v.questionTitle,children:a.questionTitle}),e.jsx(A,{children:u.map((x,g)=>e.jsx(A.Item,{ref:h[g],as:"li",className:"d-flex justify-content-between align-items-start",onClick:p=>I(p,x.isCorrect),children:e.jsx("div",{className:"ms-2 me-auto",children:e.jsx("div",{className:"fw-bold",children:x.answer})})},x.answer))})]}),e.jsxs(f.Footer,{className:"d-flex justify-content-center",children:[e.jsx(z,{variant:"secondary",disabled:s===0,onClick:W,children:"Previous Question"}),e.jsx(z,{onClick:T,variant:"primary",children:"Next Question"}),e.jsxs("h6",{children:["Total Questions: ",s+1," of ",t.length]})]})]})})},ke=({handleModal:r})=>{const o=()=>{r()};return e.jsx(k.Link,{onClick:o,as:z,children:"Start Quiz"})},ze="_text_glmkh_1",Be={text:ze};function Ie({handleClose:r,show:o}){const t=X(),s=ue(a=>a.setActive),d=a=>{s(a),t(a)};return e.jsxs(f,{show:o,onHide:r,centered:!0,children:[e.jsx(f.Header,{closeButton:!0,children:e.jsx(f.Title,{as:"h5",className:"text-center",children:"Sorry!"})}),e.jsx(f.Body,{children:e.jsxs("p",{className:Be.text,children:["You need to be logged in to add this quiz to your collection. ",e.jsx("br",{}),"Please"," ",e.jsx(M,{to:"/login",className:"text-primary",onClick:()=>d("login"),children:"log in"})," ","or"," ",e.jsx(M,{to:"/signup",className:"text-primary",onClick:()=>d("signup"),children:"sign up"})," ","to add this quiz to your collection."]})}),e.jsx(f.Footer,{children:e.jsx(z,{onClick:r,children:"Close"})})]})}const Le=({quiz:{title:r,complexity:o,description:t,id:s,authorName:d,publishedAt:a,questions:j}})=>{const[u,c]=n.useState(!1),[m,i]=n.useState(!1),[l,N]=n.useState(!1),B=()=>c(!1),C=()=>c(!0),w=()=>N(!1),{currentUser:y,setCurrentUser:L}=D(),F=async h=>{if(!y){N(!0);return}if(!h.target.checked){await E(h.target.id,y.id,"remove"),i(!1),L(I=>({...I??{},favorites:y.favorites.filter(T=>T!==h.target.id)}));return}await E(h.target.id,y.id,"add"),i(!0),L(I=>({...I??{},favorites:[...y.favorites,h.target.id]}))};return n.useEffect(()=>{y&&y.favorites.includes(s)&&i(!0)},[]),e.jsxs(k.Body,{className:S.cardBody,children:[e.jsx("div",{className:S.checkbox,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:m,onChange:h=>F(h),id:s}),m?e.jsx(re,{className:S.favoriteIcon,style:{fill:"#F7941D"}}):e.jsx(oe,{className:S.favoriteIcon,style:{fill:"gray"}})]})}),e.jsx(k.Title,{children:P(r,40)}),e.jsx(k.Subtitle,{className:"mb-2 text-muted",children:o}),e.jsx(k.Text,{className:S.quizDescription,children:P(t,80)}),e.jsxs("div",{className:S.buttonContainer,children:[e.jsx(ke,{handleModal:C}),e.jsx(k.Link,{as:z,children:"Share Quiz"})]}),e.jsxs("small",{className:S.itemSmalltext,children:["Published on: ",a.toLocaleDateString()," by ",d]}),u&&e.jsx(Se,{show:u,handleClose:B,questions:j}),l&&e.jsx(Ie,{handleClose:w,show:l})]})},Qe=({quizes:r})=>e.jsx(U,{style:{paddingBottom:"80px",marginTop:"20px"},children:r.map(o=>e.jsx(k,{style:{width:"100%",marginBottom:"10px"},children:e.jsx(Le,{quiz:o})},o.id))}),we="_container_clstf_1",Fe="_form_clstf_7",Te="_button_clstf_19",Oe="_error_clstf_29",Q={container:we,form:Fe,button:Te,error:Oe},$e="_selectCategory_13j12_1",Me={selectCategory:$e},R=({fields:r,fieldsName:o,handleChange:t})=>e.jsxs(q.Select,{className:Me.selectCategory,onChange:s=>t(s.target.value),defaultValue:`Open ${o} menu`,children:[e.jsx("option",{children:`Open ${o} menu`}),r.map(s=>e.jsx("option",{value:s,children:s},s))]}),Ee=Object.values(J),Pe=Object.values(ee),Ae={category:"",complexity:""},Re=()=>{const[r,o]=Z(Ae),[t,s]=n.useState(r.get("category")??""),[d,a]=n.useState(r.get("complexity")??""),[j,u]=n.useState(!1),c=l=>{if(l.preventDefault(),!t&&!d){u(!0);return}o({category:t,complexity:d})},m=l=>{if(console.log(l),l==="Open category menu"){s("");return}u(!1),s(l)},i=l=>{if(console.log(l),l==="Open complexity menu"){a("");return}u(!1),a(l)};return e.jsxs(U,{className:Q.container,children:[e.jsxs(q,{className:Q.form,onSubmit:c,children:[e.jsx(R,{fields:Ee,fieldsName:"category",handleChange:m}),e.jsx(R,{fields:Pe,fieldsName:"complexity",handleChange:i}),e.jsx(z,{className:Q.button,type:"submit",children:"Search"})]}),j&&e.jsx("p",{className:Q.error,children:"Please select search query"})]})},st=()=>{const r=te(),o=se(),{currentUser:t}=D();return e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),t&&e.jsx(ne,{}),r.state==="loading"?e.jsx(he,{}):e.jsx(Qe,{quizes:o})]})};export{st as default};
